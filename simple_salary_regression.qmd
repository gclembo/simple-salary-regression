---
title: "Simple Salary Regression"
date: "`r Sys.Date()`"
author: Carter Lembo
format: 
  html:
    toc: true
editor: 
  markdown: 
    wrap: 72
---

## Intro

My goal here is to create a simple regression model between the years of
experience and salary from the Salary dataset from the user Sadiq on
Kaggle[^1]

[^1]: https://www.kaggle.com/datasets/rsadiq/salary

## Setup

I will be using packages such as dplyr and ggplot2 in the tidyverse for
data manipulation and visualization.

```{r}
#| label: setup
#| output: false

library(tidyverse)

```

## Load Data

I am loading the data from "Salary.csv" in my "data" folder. Using the
glimpse function I can see there are 35 operations. Each row contains
the years of experience and the salary for an individual.

```{r}
#| label: load-data

salary_df <- read.csv("data/Salary.csv")

salary_df |> 
  glimpse()
```

## Exploration

### Values

Let's explore the salary values in the dataset. While it is not
specified, it seems safe to assume salary is in US dollars.

```{r}
#| label: value-explore

mean(salary_df$Salary)
median(salary_df$Salary)
range(salary_df$Salary)


```

### Visualization

I can visually explore the relationship between these two variables
using a scatter plot. From the plot it is clear the data is roughly
linear and the line of best fit seems like a good model.

```{r}
#| label: fig-years-vs-salary
#| fig-cap: Years of Experience vs. Salary Scatterplot

salary_df |> 
  ggplot(aes(YearsExperience, Salary)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +
  labs(
    title = "Years of Experience vs Salary",
    subtitle = "Data relating salary and experience",
    x = "Years of Experience",
    y = "Salary (USD)",
    caption = "Data from user Sadiq on Kaggle (https://www.kaggle.com/datasets/rsadiq/salary)."
  ) +
  theme_bw()
```

## Modeling

I am creating a linear model where years of experiences are used to
predict the salary of an employee.

```{r}
#| label: modeling

model <- lm(Salary ~ YearsExperience, data = salary_df)

model_summary <- summary(model)
model_summary

```

This gives an $R^2$ value of `r model_summary$r.squared`. I can also see that
based on a model, an increase of 1 year of experience corresponds to an 
expected increase in salary of \$`r model_summary$coefficients[2]`

### Residuals

Looking at the residuals I can see that there is no apparent pattern so
the linear model is appropriate.

```{r}
#| label: fig-residuals
#| fig-cap: Residuals of Model
broom::augment(model) |>
  ggplot(aes(x = .fitted, y = .resid)) +
  geom_abline(slope = 0, intercept = 0, color = "blue") +
  geom_point() +
  labs(x = "Predicted", y = "Residual") +
  theme_bw()

```

### Predictions

Just for fun I am predicting with the model the expected salary for 3, 5, 
and 7 years of experience.

```{r}
#| label: predictions

fake_data <- data.frame(YearsExperience = c(3, 5, 7))

predict.lm(model, fake_data)


```
